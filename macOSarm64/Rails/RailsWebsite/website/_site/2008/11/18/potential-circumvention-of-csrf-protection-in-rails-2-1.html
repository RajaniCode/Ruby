<!doctype html>
<html lang="en">








<head>
  <title>Ruby on Rails &mdash; Potential Circumvention of CSRF Protection in Rails 2.1</title>
  <meta charset="utf-8" />
  <meta content="ie=edge" http-equiv="x-ua-compatible" />
  <meta name="handheldfriendly" content="true" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="There is a bug in all 2.1.x versions of Ruby on Rails which affects the effectiveness of the CSRF protection given by protect_from_forgery.By design rails does not perform token verification on requests with certain content types not typically generated by browsers.  Unfortunately this list also included &#8216;text/plain&#8217; which can be generated by browsers.ImpactRequests can be crafted which will circumvent the CSRF protection entirely.  Rails does not parse the parameters provided with these requests, but that may not be enough to protect your application.Affected Versions	All releases in the 2.1 series	All 2.2 Pre ReleasesFixesThe upcoming 2.1.3 and 2.2.2 releases will contain a fix for this issue.Interim WorkaroundsUsers of 2.1.x releases are advised to insert the following code into a file in config/initializers/&gt;  Mime::Type.unverifiable_types.delete(:text)Users of Edge Rails after 2.2.1, should upgrade to the latest code in 2-2-stable.The patch for the 2.1.x series is available on github. This will also apply cleanly to 2.2 pre-releases prior to this changeset released on Thursday November 13th at 11:19:53 2008 CET.  Users with edge-rails checkouts after that date, are advised to upgrade to the latest code in 2-2-stable.Thanks to Steve from Coderrr for reporting this issue." />

  <meta property="og:site_name" content="Ruby on Rails" />
  <meta property="og:title" content="Potential Circumvention of CSRF Protection in Rails 2.1" />
  <meta property="og:description" content="There is a bug in all 2.1.x versions of Ruby on Rails which affects the effectiveness of the CSRF protection given by protect_from_forgery.By design rails does not perform token verification on requests with certain content types not typically generated by browsers.  Unfortunately this list also included &#8216;text/plain&#8217; which can be generated by browsers.ImpactRequests can be crafted which will circumvent the CSRF protection entirely.  Rails does not parse the parameters provided with these requests, but that may not be enough to protect your application.Affected Versions	All releases in the 2.1 series	All 2.2 Pre ReleasesFixesThe upcoming 2.1.3 and 2.2.2 releases will contain a fix for this issue.Interim WorkaroundsUsers of 2.1.x releases are advised to insert the following code into a file in config/initializers/&gt;  Mime::Type.unverifiable_types.delete(:text)Users of Edge Rails after 2.2.1, should upgrade to the latest code in 2-2-stable.The patch for the 2.1.x series is available on github. This will also apply cleanly to 2.2 pre-releases prior to this changeset released on Thursday November 13th at 11:19:53 2008 CET.  Users with edge-rails checkouts after that date, are advised to upgrade to the latest code in 2-2-stable.Thanks to Steve from Coderrr for reporting this issue." />
  <meta property="og:image" content="http://localhost:4000/assets/images/opengraph.png" />
  <meta property="og:url" content="http://localhost:4000/2008/11/18/potential-circumvention-of-csrf-protection-in-rails-2-1" />
  <meta property="og:type" content="article" />

  <meta name="twitter:title" content="Potential Circumvention of CSRF Protection in Rails 2.1" />
  <meta name="twitter:description" content="There is a bug in all 2.1.x versions of Ruby on Rails which affects the effectiveness of the CSRF protection given by protect_from_forgery.By design rails does not perform token verification on requests with certain content types not typically generated by browsers.  Unfortunately this list also included &#8216;text/plain&#8217; which can be generated by browsers.ImpactRequests can be crafted which will circumvent the CSRF protection entirely.  Rails does not parse the parameters provided with these requests, but that may not be enough to protect your application.Affected Versions	All releases in the 2.1 series	All 2.2 Pre ReleasesFixesThe upcoming 2.1.3 and 2.2.2 releases will contain a fix for this issue.Interim WorkaroundsUsers of 2.1.x releases are advised to insert the following code into a file in config/initializers/&gt;  Mime::Type.unverifiable_types.delete(:text)Users of Edge Rails after 2.2.1, should upgrade to the latest code in 2-2-stable.The patch for the 2.1.x series is available on github. This will also apply cleanly to 2.2 pre-releases prior to this changeset released on Thursday November 13th at 11:19:53 2008 CET.  Users with edge-rails checkouts after that date, are advised to upgrade to the latest code in 2-2-stable.Thanks to Steve from Coderrr for reporting this issue." />
  <meta name="twitter:image" content="http://localhost:4000/assets/images/opengraph.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:creator" content="@rails" />
  <meta name="twitter:image:alt" content="Ruby on Rails" />

  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BlogPosting",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:4000/2008/11/18/potential-circumvention-of-csrf-protection-in-rails-2-1"
      },
      "name": "Ruby on Rails",
      "headline": "Potential Circumvention of CSRF Protection in Rails 2.1",
      "description": "There is a bug in all 2.1.x versions of Ruby on Rails which affects the effectiveness of the CSRF protection given by protect_from_forgery.By design rails does not perform token verification on requests with certain content types not typically generated by browsers.  Unfortunately this list also included &#8216;text/plain&#8217; which can be generated by browsers.ImpactRequests can be crafted which will circumvent the CSRF protection entirely.  Rails does not parse the parameters provided with these requests, but that may not be enough to protect your application.Affected Versions	All releases in the 2.1 series	All 2.2 Pre ReleasesFixesThe upcoming 2.1.3 and 2.2.2 releases will contain a fix for this issue.Interim WorkaroundsUsers of 2.1.x releases are advised to insert the following code into a file in config/initializers/&gt;  Mime::Type.unverifiable_types.delete(:text)Users of Edge Rails after 2.2.1, should upgrade to the latest code in 2-2-stable.The patch for the 2.1.x series is available on github. This will also apply cleanly to 2.2 pre-releases prior to this changeset released on Thursday November 13th at 11:19:53 2008 CET.  Users with edge-rails checkouts after that date, are advised to upgrade to the latest code in 2-2-stable.Thanks to Steve from Coderrr for reporting this issue.",
      "url": "http://localhost:4000/2008/11/18/potential-circumvention-of-csrf-protection-in-rails-2-1",
      "image": "http://localhost:4000/assets/images/opengraph.png",
      "author": {
        "@type": "Person",
        "name": "michael"
      },
      "datePublished": "2008-11-18T23:43:00+05:30"
    }
  </script>
  <script defer data-domain="rubyonrails.org" src="https://plausible.io/js/script.js"></script>
  <link rel="icon" href="/assets/images/favicon.png" />
  <link rel="stylesheet" href="/assets/css/style.css" />
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="The official Ruby on Rails blog">
</head>


<body>


<nav class="nav">
  <a class="nav__logo" href="/" aria-label="Ruby on Rails"></a>

  <input class="nav__checkbox" id="nav__checkbox" type="checkbox" role="button" aria-label="menu" />

  <label class="nav__toggle" for="nav__checkbox">
    <span></span>
  </label>

  <div class="nav__options">
    <div>
      <ul>
        
          
            <li><a href="https://github.com/rails/rails"><span>Source</span></a></li>
          
        
          
            <li><a href="/docs"><span>Docs</span></a></li>
          
        
          
            <li><a href="/community"><span>Community</span></a></li>
          
        
          
            <li><a href="/blog"><span>News</span></a></li>
          
        
      </ul>

      <ul>
        
          
            <li><a href="/world"><span>Events</span></a></li>
          
        
          
            <li><a href="https://jobs.rubyonrails.org"><span>Jobs</span></a></li>
          
        
          
            <li><a href="https://merch.rubyonrails.org"><span>Merch</span></a></li>
          
        
          
            <li><a href="/foundation"><span>Foundation</span></a></li>
          
        
      </ul>
    </div>
  </div>
</nav>


<div class="layout">
  <div class="post common-padding--bottom common-padding--top-small">
    <div class="container">
      <div class="post__headline common-headline">
        <h5>Tuesday, November 18, 2008</h5>
        <h2>Potential Circumvention of CSRF Protection in Rails 2.1</h2>

        <h6>Posted by michael</h6>

      </div>
      <div class="post__content common-content common-content--post">
        <p>There is a bug in all 2.1.x versions of Ruby on Rails which affects the effectiveness of the <span class="caps">CSRF</span> protection given by protect_from_forgery.</p>
<p>By design rails does not perform token verification on requests with certain content types not typically generated by browsers.  Unfortunately this list also included &#8216;text/plain&#8217; which can be generated by browsers.</p>
<h2>Impact</h2>
<p>Requests can be crafted which will circumvent the <span class="caps">CSRF</span> protection entirely.  Rails does not parse the parameters provided with these requests, but that may not be enough to protect your application.</p>
<h2>Affected Versions</h2>
<ul>
	<li>All releases in the 2.1 series</li>
	<li>All 2.2 Pre Releases</li>
</ul>
<h2>Fixes</h2>
<p>The upcoming 2.1.3 and 2.2.2 releases will contain a fix for this issue.</p>
<h2>Interim Workarounds</h2>
<p>Users of 2.1.x releases are advised to insert the following code into a file in config/initializers/</p>
<p>&gt;  Mime::Type.unverifiable_types.delete(:text)</p>
<p>Users of Edge Rails after 2.2.1, should upgrade to the latest code in 2-2-stable.</p>
<p>The patch for the 2.1.x series is available on <a href="http://github.com/rails/rails/commit/099a98e9b7108dae3e0f78b207e0a7dc5913bd1a">github</a>. This will also apply cleanly to 2.2 pre-releases prior to <a href="http://github.com/rails/rails/commit/f1ad8b48aae3ee26613b3e77bc0056e120096846">this changeset</a> released on Thursday November 13th at 11:19:53 2008 <span class="caps">CET</span>.  Users with edge-rails checkouts after that date, are advised to upgrade to the latest code in 2-2-stable.</p>
<p>Thanks to <a href="http://coderrr.wordpress.com/">Steve from Coderrr</a> for reporting this issue.</p>

      </div>
    </div>
  </div>
</div>

<footer class="footer common-background--grey common-padding--bottom common-padding--top common-shape--top-white-up-left">
  <div class="footer__logo"><a href="/" aria-label="Ruby on Rails"></a></div>

  
</footer>

</body>
</html>
