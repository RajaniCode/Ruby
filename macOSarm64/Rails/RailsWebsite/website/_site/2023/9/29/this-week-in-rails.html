<!doctype html>
<html lang="en">








<head>
  <title>Ruby on Rails &mdash; This Week in Rails - September 29</title>
  <meta charset="utf-8" />
  <meta content="ie=edge" http-equiv="x-ua-compatible" />
  <meta name="handheldfriendly" content="true" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Hi, Wojtek here. The Rails World starts next week. Three members of the current This Week In Rails editorial team — Greg, Emmanuel, and myself — will be in attendance. We’ve got some stickers featuring the newsletter’s logo, so be sure to spot us to snag one! Now, let’s delve into the latest updates in the Rails codebase." />

  <meta property="og:site_name" content="Ruby on Rails" />
  <meta property="og:title" content="This Week in Rails - September 29" />
  <meta property="og:description" content="Hi, Wojtek here. The Rails World starts next week. Three members of the current This Week In Rails editorial team — Greg, Emmanuel, and myself — will be in attendance. We’ve got some stickers featuring the newsletter’s logo, so be sure to spot us to snag one! Now, let’s delve into the latest updates in the Rails codebase." />
  <meta property="og:image" content="http://localhost:4000/assets/images/opengraph.png" />
  <meta property="og:url" content="http://localhost:4000/2023/9/29/this-week-in-rails" />
  <meta property="og:type" content="article" />

  <meta name="twitter:title" content="This Week in Rails - September 29" />
  <meta name="twitter:description" content="Hi, Wojtek here. The Rails World starts next week. Three members of the current This Week In Rails editorial team — Greg, Emmanuel, and myself — will be in attendance. We’ve got some stickers featuring the newsletter’s logo, so be sure to spot us to snag one! Now, let’s delve into the latest updates in the Rails codebase." />
  <meta name="twitter:image" content="http://localhost:4000/assets/images/opengraph.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:creator" content="@rails" />
  <meta name="twitter:image:alt" content="Ruby on Rails" />

  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BlogPosting",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:4000/2023/9/29/this-week-in-rails"
      },
      "name": "Ruby on Rails",
      "headline": "This Week in Rails - September 29",
      "description": "Hi, Wojtek here. The Rails World starts next week. Three members of the current This Week In Rails editorial team — Greg, Emmanuel, and myself — will be in attendance. We’ve got some stickers featuring the newsletter’s logo, so be sure to spot us to snag one! Now, let’s delve into the latest updates in the Rails codebase.",
      "url": "http://localhost:4000/2023/9/29/this-week-in-rails",
      "image": "http://localhost:4000/assets/images/opengraph.png",
      "author": {
        "@type": "Person",
        "name": "wojtek"
      },
      "datePublished": "2023-09-29T00:00:00+05:30"
    }
  </script>
  <script defer data-domain="rubyonrails.org" src="https://plausible.io/js/script.js"></script>
  <link rel="icon" href="/assets/images/favicon.png" />
  <link rel="stylesheet" href="/assets/css/style.css" />
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="The official Ruby on Rails blog">
</head>


<body>


<nav class="nav">
  <a class="nav__logo" href="/" aria-label="Ruby on Rails"></a>

  <input class="nav__checkbox" id="nav__checkbox" type="checkbox" role="button" aria-label="menu" />

  <label class="nav__toggle" for="nav__checkbox">
    <span></span>
  </label>

  <div class="nav__options">
    <div>
      <ul>
        
          
            <li><a href="https://github.com/rails/rails"><span>Source</span></a></li>
          
        
          
            <li><a href="/docs"><span>Docs</span></a></li>
          
        
          
            <li><a href="/community"><span>Community</span></a></li>
          
        
          
            <li><a href="/blog"><span>News</span></a></li>
          
        
      </ul>

      <ul>
        
          
            <li><a href="/world"><span>Events</span></a></li>
          
        
          
            <li><a href="https://jobs.rubyonrails.org"><span>Jobs</span></a></li>
          
        
          
            <li><a href="https://merch.rubyonrails.org"><span>Merch</span></a></li>
          
        
          
            <li><a href="/foundation"><span>Foundation</span></a></li>
          
        
      </ul>
    </div>
  </div>
</nav>


<div class="layout">
  <div class="post common-padding--bottom common-padding--top-small">
    <div class="container">
      <div class="post__headline common-headline">
        <h5>Friday, September 29, 2023</h5>
        <h2>This Week in Rails - September 29</h2>

        <h6>Posted by wojtek</h6>

      </div>
      <div class="post__content common-content common-content--post">
        <p>Hi, <a href="https://twitter.com/morgoth85">Wojtek</a> here. The <a href="https://rubyonrails.org/world">Rails World</a> starts next week. Three members of the current <em>This Week In Rails</em> editorial team — Greg, Emmanuel, and myself — will be in attendance. We’ve got some stickers featuring the newsletter’s logo, so be sure to spot us to snag one! Now, let’s delve into the latest updates in the Rails codebase.</p>

<p><a href="https://github.com/rails/rails/releases/tag/v7.1.0.rc1">Rails 7.1.0.rc1 released</a><br />
Getting us closer to the final release of the Rails 7.1.</p>

<p><a href="https://github.com/rails/rails/pull/48615">Add a public API for broadcasting logs</a><br />
This feature existed for a while but was until now a private API.
Broadcasting log allows to send log message to difference sinks (<em>STDOUT</em>, file, etc.) and is used by default in the development environment to write logs both on <em>STDOUT</em> and in the
“development.log” file.</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">broadcast</span> <span class="o">=</span> <span class="no">ActiveSupport</span><span class="o">::</span><span class="no">BroadcastLogger</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="no">Logger</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="no">STDOUT</span><span class="p">),</span> <span class="no">Logger</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="s2">"development.log"</span><span class="p">))</span>
<span class="n">broadcast</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s2">"Hello!"</span><span class="p">)</span> <span class="c1"># The "Hello!" message is written on STDOUT and in the log file.</span>
</code></pre></div></div>

<p><a href="https://github.com/rails/rails/pull/45606">Allow attaching File or Pathname to has_one_attached</a><br />
This might be especially handy when creating models in tests, as it’s easier to pass a <em>File</em> or a <em>Pathname</em> (from <em>file_fixture</em> for instance)</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">User</span><span class="p">.</span><span class="nf">create!</span><span class="p">(</span><span class="ss">avatar: </span><span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="s2">"image.jpg"</span><span class="p">))</span>
<span class="no">User</span><span class="p">.</span><span class="nf">create!</span><span class="p">(</span><span class="ss">avatar: </span><span class="n">file_fixture</span><span class="p">(</span><span class="s2">"image.jpg"</span><span class="p">))</span>
</code></pre></div></div>

<p><a href="https://github.com/rails/rails/pull/49194">Introduce ActionView::TestCase.register_parser</a><br />
Register a callable to decode rendered content for a given MIME type.<br />
Each registered parser will also define a <em>#rendered.$MIME</em> helper method, where <em>$MIME</em> corresponds to the value of the <em>mime</em> argument.</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">register_parser</span> <span class="ss">:rss</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="n">rendered</span> <span class="p">{</span> <span class="no">RSS</span><span class="o">::</span><span class="no">Parser</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">rendered</span><span class="p">)</span> <span class="p">}</span>
</code></pre></div></div>
<p>By default, parsers for <em>:html</em> and <em>:json</em> are registered.</p>

<p><a href="https://github.com/rails/rails/pull/49175">HTML tag validation added for tag names</a><br />
Added validation for HTML tag names in the <em>tag</em> and <em>content_tag</em> helper method. Those methods now check that the provided tag name adheres to the HTML specification. If an invalid HTML tag name is provided, the method raises an <em>ArgumentError</em> with an appropriate error message.</p>

<p><a href="https://github.com/rails/rails/pull/48115">Add expires_at option to ActiveStorage::Blob#signed_id</a><br />
Providing <em>expires_at</em> will expire the link after given the time:</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rails_blob_path</span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="nf">avatar</span><span class="p">,</span> <span class="ss">disposition: </span><span class="s2">"attachment"</span><span class="p">,</span> <span class="ss">expires_at: </span><span class="mi">30</span><span class="p">.</span><span class="nf">minutes</span><span class="p">.</span><span class="nf">from_now</span><span class="p">)</span>
</code></pre></div></div>

<p><a href="https://github.com/rails/rails/pull/48542">Introduce ActionMailer::FormBuilder</a><br />
Use the <em>default_form_builder</em> method in mailers to set the default form builder for templates rendered by that mailer. Matches the behavior in Action Controller.</p>

<p><a href="https://github.com/rails/rails/pull/45411">Factor out deep_merge into Active Support DeepMergeable</a><br />
The <em>ActiveSupport::DeepMergeable</em> module allows a class to provide <em>deep_merge</em> and <em>deep_merge!</em> methods simply by implementing a <em>merge!(other, &amp;block)</em> method. Values will be deep merged only when they are compatible, according to <em>deep_merge?</em> method. By default, that only includes instances of the same class or its subclasses. A class may override <em>deep_merge?</em> to further restrict or expand the domain of deep mergeable values.<br />
This allowed to <a href="https://github.com/rails/rails/pull/45369">support deep_merge on ActionController::Parameters</a></p>

<p><a href="https://github.com/rails/rails/pull/49356">Fix Range#overlap? ignoring empty ranges</a><br />
Previously, <em>#overlap?</em> would incorrectly return true when one of the ranges was effectively “empty”.<br />
<a href="https://bugs.ruby-lang.org/issues/19839">Ruby 3.3 introduces Range#overlap?</a> so this also ensures that both implementations return same results.</p>

<p><a href="https://github.com/rails/rails/pull/49349">Performance tune the SQLite3 adapter connection configuration</a><br />
For Rails applications, the Write-Ahead-Log in normal syncing mode with a capped journal size, a healthy shared memory buffer and a shared cache will perform, on average, 2× better.</p>

<p><a href="https://github.com/rails/rails/pull/49352">Allow SQLite3 busy_handler to be configured with simple max number of retries</a><br />
Retrying busy connections without delay is a preferred practice for performance-sensitive applications. Add support for a <em>database.yml</em> <em>retries</em> integer, which is used in a simple <em>busy_handler</em> function to retry busy connections without exponential backoff up to the max number of <em>retries</em>.</p>

<p><a href="https://github.com/rails/rails/pull/48066">Set Active Job scheduled_at attribute as a Time object</a><br />
Serialize and deserialize the value of <em>scheduled_at</em> as a Time object. Deserialize <em>enqueued_at</em> as a Time object as well.
In addition assigning a numeric/epoch value to <em>scheduled_at=</em> is deprecated.</p>

<p><a href="https://github.com/rails/rails/pull/42429">Fix duplicate escaping of quotes for check constraint expressions in MySQL schema</a><br />
A check constraint with an expression, that already contains quotes, lead to an invalid schema dump with the <em>mysql2</em> adapter.</p>

<p><em>You can view the whole list of changes <a href="https://github.com/rails/rails/compare/@%7B2023-09-22%7D...main@%7B2023-09-29%7D">here</a>.</em><br />
<em>We had <a href="https://contributors.rubyonrails.org/contributors/in-time-window/20230922-20230929">39 contributors</a> to the Rails codebase this past week!</em></p>

<p>Until next time!</p>

<p><em><a href="https://world.hey.com/this.week.in.rails">Subscribe</a> to get these updates mailed to you.</em></p>

      </div>
    </div>
  </div>
</div>

<footer class="footer common-background--grey common-padding--bottom common-padding--top common-shape--top-white-up-left">
  <div class="footer__logo"><a href="/" aria-label="Ruby on Rails"></a></div>

  
</footer>

</body>
</html>
