<!doctype html>
<html lang="en">








<head>
  <title>Ruby on Rails &mdash; Nested attributes for delegated types, improved performances and more!</title>
  <meta charset="utf-8" />
  <meta content="ie=edge" http-equiv="x-ua-compatible" />
  <meta name="handheldfriendly" content="true" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Hey! Robin here with the latest news from the Ruby on Rails world.Support accepts_nested_attributes_for for delegated typesRails 6.1 introduced delegated types to ease handling some polymorphic relationships. This pull request makes using accepts_nested_attributes_for on such types a piece of cake.Use nested queries doing UPDATE with GROUP BY and HAVING on MySQLSince MySQL doesn’t support UPDATE with GROUP BY and HAVING clauses, this patch fixes such scenario to rely on a sub-query. A similar patch has been merged to deal with DELETE queries.Raise a specific error on unsafe redirectsRails 7.0 prevents redirects to other hosts than the current one unless you explicitly ask it to. In case of unsafe redirects, an ArgumentError was raised. Now, the error is more specific, allowing you to rely on a rescue_from block to deal with such cases.Add url_from to check if an URL is internalIn line with the previous patch, a new url_from method is available in controllers to check whether an URL is internal or not, simplifying the way to provide an alternative in case it is not.Improved Active Job test helpers error messagesThis is the kind of little changes that make life easier. The error messages of assert_enqueued_with and assert_performed_with have been improved to ease debugging when the assertion failed. Happy testing!Optimize ActiveSupport::CurrentAttributes method generationIt’s always lovely to see performance optimizations. This patch is about method generation of classes inheriting from ActiveSupport::CurrentAttributes. The trick here is to generate the code as a string rather than relying on a closure.13 people contributed to Rails since last time. All the changes can be checked here. Until next week!" />

  <meta property="og:site_name" content="Ruby on Rails" />
  <meta property="og:title" content="Nested attributes for delegated types, improved performances and more!" />
  <meta property="og:description" content="Hey! Robin here with the latest news from the Ruby on Rails world.Support accepts_nested_attributes_for for delegated typesRails 6.1 introduced delegated types to ease handling some polymorphic relationships. This pull request makes using accepts_nested_attributes_for on such types a piece of cake.Use nested queries doing UPDATE with GROUP BY and HAVING on MySQLSince MySQL doesn’t support UPDATE with GROUP BY and HAVING clauses, this patch fixes such scenario to rely on a sub-query. A similar patch has been merged to deal with DELETE queries.Raise a specific error on unsafe redirectsRails 7.0 prevents redirects to other hosts than the current one unless you explicitly ask it to. In case of unsafe redirects, an ArgumentError was raised. Now, the error is more specific, allowing you to rely on a rescue_from block to deal with such cases.Add url_from to check if an URL is internalIn line with the previous patch, a new url_from method is available in controllers to check whether an URL is internal or not, simplifying the way to provide an alternative in case it is not.Improved Active Job test helpers error messagesThis is the kind of little changes that make life easier. The error messages of assert_enqueued_with and assert_performed_with have been improved to ease debugging when the assertion failed. Happy testing!Optimize ActiveSupport::CurrentAttributes method generationIt’s always lovely to see performance optimizations. This patch is about method generation of classes inheriting from ActiveSupport::CurrentAttributes. The trick here is to generate the code as a string rather than relying on a closure.13 people contributed to Rails since last time. All the changes can be checked here. Until next week!" />
  <meta property="og:image" content="http://localhost:4000/assets/images/opengraph.png" />
  <meta property="og:url" content="http://localhost:4000/2021/11/7/this-week-in-rails-nested-attributes-for-delegated-types-improved-performances-and-more-73a8f5cf" />
  <meta property="og:type" content="article" />

  <meta name="twitter:title" content="Nested attributes for delegated types, improved performances and more!" />
  <meta name="twitter:description" content="Hey! Robin here with the latest news from the Ruby on Rails world.Support accepts_nested_attributes_for for delegated typesRails 6.1 introduced delegated types to ease handling some polymorphic relationships. This pull request makes using accepts_nested_attributes_for on such types a piece of cake.Use nested queries doing UPDATE with GROUP BY and HAVING on MySQLSince MySQL doesn’t support UPDATE with GROUP BY and HAVING clauses, this patch fixes such scenario to rely on a sub-query. A similar patch has been merged to deal with DELETE queries.Raise a specific error on unsafe redirectsRails 7.0 prevents redirects to other hosts than the current one unless you explicitly ask it to. In case of unsafe redirects, an ArgumentError was raised. Now, the error is more specific, allowing you to rely on a rescue_from block to deal with such cases.Add url_from to check if an URL is internalIn line with the previous patch, a new url_from method is available in controllers to check whether an URL is internal or not, simplifying the way to provide an alternative in case it is not.Improved Active Job test helpers error messagesThis is the kind of little changes that make life easier. The error messages of assert_enqueued_with and assert_performed_with have been improved to ease debugging when the assertion failed. Happy testing!Optimize ActiveSupport::CurrentAttributes method generationIt’s always lovely to see performance optimizations. This patch is about method generation of classes inheriting from ActiveSupport::CurrentAttributes. The trick here is to generate the code as a string rather than relying on a closure.13 people contributed to Rails since last time. All the changes can be checked here. Until next week!" />
  <meta name="twitter:image" content="http://localhost:4000/assets/images/opengraph.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:creator" content="@rails" />
  <meta name="twitter:image:alt" content="Ruby on Rails" />

  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BlogPosting",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:4000/2021/11/7/this-week-in-rails-nested-attributes-for-delegated-types-improved-performances-and-more-73a8f5cf"
      },
      "name": "Ruby on Rails",
      "headline": "Nested attributes for delegated types, improved performances and more!",
      "description": "Hey! Robin here with the latest news from the Ruby on Rails world.Support accepts_nested_attributes_for for delegated typesRails 6.1 introduced delegated types to ease handling some polymorphic relationships. This pull request makes using accepts_nested_attributes_for on such types a piece of cake.Use nested queries doing UPDATE with GROUP BY and HAVING on MySQLSince MySQL doesn’t support UPDATE with GROUP BY and HAVING clauses, this patch fixes such scenario to rely on a sub-query. A similar patch has been merged to deal with DELETE queries.Raise a specific error on unsafe redirectsRails 7.0 prevents redirects to other hosts than the current one unless you explicitly ask it to. In case of unsafe redirects, an ArgumentError was raised. Now, the error is more specific, allowing you to rely on a rescue_from block to deal with such cases.Add url_from to check if an URL is internalIn line with the previous patch, a new url_from method is available in controllers to check whether an URL is internal or not, simplifying the way to provide an alternative in case it is not.Improved Active Job test helpers error messagesThis is the kind of little changes that make life easier. The error messages of assert_enqueued_with and assert_performed_with have been improved to ease debugging when the assertion failed. Happy testing!Optimize ActiveSupport::CurrentAttributes method generationIt’s always lovely to see performance optimizations. This patch is about method generation of classes inheriting from ActiveSupport::CurrentAttributes. The trick here is to generate the code as a string rather than relying on a closure.13 people contributed to Rails since last time. All the changes can be checked here. Until next week!",
      "url": "http://localhost:4000/2021/11/7/this-week-in-rails-nested-attributes-for-delegated-types-improved-performances-and-more-73a8f5cf",
      "image": "http://localhost:4000/assets/images/opengraph.png",
      "author": {
        "@type": "Person",
        "name": "robin850"
      },
      "datePublished": "2021-11-07T00:00:00+05:30"
    }
  </script>
  <script defer data-domain="rubyonrails.org" src="https://plausible.io/js/script.js"></script>
  <link rel="icon" href="/assets/images/favicon.png" />
  <link rel="stylesheet" href="/assets/css/style.css" />
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="The official Ruby on Rails blog">
</head>


<body>


<nav class="nav">
  <a class="nav__logo" href="/" aria-label="Ruby on Rails"></a>

  <input class="nav__checkbox" id="nav__checkbox" type="checkbox" role="button" aria-label="menu" />

  <label class="nav__toggle" for="nav__checkbox">
    <span></span>
  </label>

  <div class="nav__options">
    <div>
      <ul>
        
          
            <li><a href="https://github.com/rails/rails"><span>Source</span></a></li>
          
        
          
            <li><a href="/docs"><span>Docs</span></a></li>
          
        
          
            <li><a href="/community"><span>Community</span></a></li>
          
        
          
            <li><a href="/blog"><span>News</span></a></li>
          
        
      </ul>

      <ul>
        
          
            <li><a href="/world"><span>Events</span></a></li>
          
        
          
            <li><a href="https://jobs.rubyonrails.org"><span>Jobs</span></a></li>
          
        
          
            <li><a href="https://merch.rubyonrails.org"><span>Merch</span></a></li>
          
        
          
            <li><a href="/foundation"><span>Foundation</span></a></li>
          
        
      </ul>
    </div>
  </div>
</nav>


<div class="layout">
  <div class="post common-padding--bottom common-padding--top-small">
    <div class="container">
      <div class="post__headline common-headline">
        <h5>Sunday, November 7, 2021</h5>
        <h2>Nested attributes for delegated types, improved performances and more!</h2>

        <h6>Posted by robin850</h6>

      </div>
      <div class="post__content common-content common-content--post">
        <p>Hey! <a href="https://github.com/robin850">Robin</a> here with the latest news from the Ruby on Rails world.</p>

<p><a href="https://github.com/rails/rails/pull/41717">Support accepts_nested_attributes_for for delegated types</a><br />
Rails 6.1 introduced delegated types to ease handling some polymorphic relationships. This pull request makes using <code class="language-plaintext highlighter-rouge">accepts_nested_attributes_for</code> on such types a piece of cake.</p>

<p><a href="https://github.com/rails/rails/pull/43465">Use nested queries doing UPDATE with GROUP BY and HAVING on MySQL</a><br />
Since MySQL doesn’t support <code class="language-plaintext highlighter-rouge">UPDATE</code> with <code class="language-plaintext highlighter-rouge">GROUP BY</code> and <code class="language-plaintext highlighter-rouge">HAVING</code> clauses, this patch fixes such scenario to rely on a sub-query. A <a href="https://github.com/rails/rails/pull/43580">similar patch</a> has been merged to deal with <code class="language-plaintext highlighter-rouge">DELETE</code> queries.</p>

<p><a href="https://github.com/rails/rails/commit/c3758a71af949db849d5b7f176677653e4e4fae9">Raise a specific error on unsafe redirects</a><br />
Rails 7.0 prevents redirects to other hosts than the current one unless you explicitly ask it to. In case of unsafe redirects, an <code class="language-plaintext highlighter-rouge">ArgumentError</code> was raised. Now, the error is more specific, allowing you to rely on a <code class="language-plaintext highlighter-rouge">rescue_from</code> block to deal with such cases.</p>

<p><a href="https://github.com/rails/rails/pull/43327">Add <code class="language-plaintext highlighter-rouge">url_from</code> to check if an URL is internal</a><br />
In line with the previous patch, a new <code class="language-plaintext highlighter-rouge">url_from</code> method is available in controllers to check whether an URL is internal or not, simplifying the way to provide an alternative in case it is not.</p>

<p><a href="https://github.com/rails/rails/pull/43554">Improved Active Job test helpers error messages</a><br />
This is the kind of little changes that make life easier. The error messages of <code class="language-plaintext highlighter-rouge">assert_enqueued_with</code> and <code class="language-plaintext highlighter-rouge">assert_performed_with</code> have been improved to ease debugging when the assertion failed. Happy testing!</p>

<p><a href="https://github.com/rails/rails/pull/43584">Optimize <code class="language-plaintext highlighter-rouge">ActiveSupport::CurrentAttributes</code> method generation</a><br />
It’s always lovely to see performance optimizations. This patch is about method generation of classes inheriting from <code class="language-plaintext highlighter-rouge">ActiveSupport::CurrentAttributes</code>. The trick here is to generate the code as a string rather than relying on a closure.</p>

<p><a href="https://contributors.rubyonrails.org/contributors/in-time-window/20211101-20211106">13 people</a> contributed to Rails since last time. All the changes can be checked <a href="https://github.com/rails/rails/compare/@%7B2021-11-01%7D...main@%7B2021-11-06%7D">here</a>. Until next week!</p>


      </div>
    </div>
  </div>
</div>

<footer class="footer common-background--grey common-padding--bottom common-padding--top common-shape--top-white-up-left">
  <div class="footer__logo"><a href="/" aria-label="Ruby on Rails"></a></div>

  
</footer>

</body>
</html>
