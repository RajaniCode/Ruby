<!doctype html>
<html lang="en">








<head>
  <title>Ruby on Rails &mdash; Composable blobs, improved upsert and much more!</title>
  <meta charset="utf-8" />
  <meta content="ie=edge" http-equiv="x-ua-compatible" />
  <meta name="handheldfriendly" content="true" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Hey, Wojtek here with recent additions to Rails. All of them today for FREE, for you.Thank you all the contributors for making Rails. Those from one-time to day by day committers." />

  <meta property="og:site_name" content="Ruby on Rails" />
  <meta property="og:title" content="Composable blobs, improved upsert and much more!" />
  <meta property="og:description" content="Hey, Wojtek here with recent additions to Rails. All of them today for FREE, for you.Thank you all the contributors for making Rails. Those from one-time to day by day committers." />
  <meta property="og:image" content="http://localhost:4000/assets/images/opengraph.png" />
  <meta property="og:url" content="http://localhost:4000/2021/11/26/this-week-in-rails-composable-blobs-improved-upsert-and-much-more-38eb3426" />
  <meta property="og:type" content="article" />

  <meta name="twitter:title" content="Composable blobs, improved upsert and much more!" />
  <meta name="twitter:description" content="Hey, Wojtek here with recent additions to Rails. All of them today for FREE, for you.Thank you all the contributors for making Rails. Those from one-time to day by day committers." />
  <meta name="twitter:image" content="http://localhost:4000/assets/images/opengraph.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:creator" content="@rails" />
  <meta name="twitter:image:alt" content="Ruby on Rails" />

  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BlogPosting",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:4000/2021/11/26/this-week-in-rails-composable-blobs-improved-upsert-and-much-more-38eb3426"
      },
      "name": "Ruby on Rails",
      "headline": "Composable blobs, improved upsert and much more!",
      "description": "Hey, Wojtek here with recent additions to Rails. All of them today for FREE, for you.Thank you all the contributors for making Rails. Those from one-time to day by day committers.",
      "url": "http://localhost:4000/2021/11/26/this-week-in-rails-composable-blobs-improved-upsert-and-much-more-38eb3426",
      "image": "http://localhost:4000/assets/images/opengraph.png",
      "author": {
        "@type": "Person",
        "name": "morgoth85"
      },
      "datePublished": "2021-11-26T00:00:00+05:30"
    }
  </script>
  <script defer data-domain="rubyonrails.org" src="https://plausible.io/js/script.js"></script>
  <link rel="icon" href="/assets/images/favicon.png" />
  <link rel="stylesheet" href="/assets/css/style.css" />
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="The official Ruby on Rails blog">
</head>


<body>


<nav class="nav">
  <a class="nav__logo" href="/" aria-label="Ruby on Rails"></a>

  <input class="nav__checkbox" id="nav__checkbox" type="checkbox" role="button" aria-label="menu" />

  <label class="nav__toggle" for="nav__checkbox">
    <span></span>
  </label>

  <div class="nav__options">
    <div>
      <ul>
        
          
            <li><a href="https://github.com/rails/rails"><span>Source</span></a></li>
          
        
          
            <li><a href="/docs"><span>Docs</span></a></li>
          
        
          
            <li><a href="/community"><span>Community</span></a></li>
          
        
          
            <li><a href="/blog"><span>News</span></a></li>
          
        
      </ul>

      <ul>
        
          
            <li><a href="/world"><span>Events</span></a></li>
          
        
          
            <li><a href="https://jobs.rubyonrails.org"><span>Jobs</span></a></li>
          
        
          
            <li><a href="https://merch.rubyonrails.org"><span>Merch</span></a></li>
          
        
          
            <li><a href="/foundation"><span>Foundation</span></a></li>
          
        
      </ul>
    </div>
  </div>
</nav>


<div class="layout">
  <div class="post common-padding--bottom common-padding--top-small">
    <div class="container">
      <div class="post__headline common-headline">
        <h5>Friday, November 26, 2021</h5>
        <h2>Composable blobs, improved upsert and much more!</h2>

        <h6>Posted by morgoth85</h6>

      </div>
      <div class="post__content common-content common-content--post">
        <p>Hey, <a href="https://twitter.com/morgoth85">Wojtek</a> here with recent additions to Rails. All of them today for FREE, for you.<br />
Thank you <a href="https://contributors.rubyonrails.org/contributors">all the contributors</a> for making Rails. Those from one-time to day by day committers.</p>

<p><a href="https://github.com/rails/rails/pull/41544"><strong>Add compose method to Active Storage Blob</strong></a><br />
Concatenating multiple blobs is now possible.</p>

<p><a href="https://github.com/rails/rails/pull/43294"><strong>Support custom metadata on Active Storage</strong></a><br />
Setting custom metadata on blobs are now persisted to remote storage.</p>

<p><a href="https://github.com/rails/rails/pull/43470"><strong>Allow to configure the list of columns to update in upsert_all</strong></a><br />
Before, you could only customize the update SQL sentence via <em>:on_duplicate</em>. There is now a new option <em>:update_only</em> that lets you provide a list of columns to update in case of conflict.</p>

<p><a href="https://github.com/rails/rails/pull/43696"><strong>Expose role/shard on pool/connection</strong></a><br />
It can be useful to know what the role and shard of the connection or pool is. Previously there was no way to find the role or shard other than asking <em>connected_to?.</em></p>

<p><a href="https://github.com/rails/rails/pull/43716"><strong>Allow a fallback value to be returned from Rails.error.handle</strong></a><br />
The passed fallback will be returned in case the code inside the <em>handle</em> block raises an error.<br />
<a href="https://github.com/rails/rails/pull/43719">Improved later</a> to make a fallback option to be a callable.</p>

<p><a href="https://github.com/rails/rails/pull/43726"><strong>Add existence method to Pathname</strong></a><br />
Shorthand for code like:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Rails.root.join('file').exist? &amp;&amp; Rails.root.join('file').read
</code></pre></div></div>

<p>to:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Rails.root.join('file').existence&amp;.read
</code></pre></div></div>

<p><a href="https://github.com/rails/rails/pull/41769"><strong>Change default X-XSS-Protection header to ‘0’</strong></a></p>

<p>This header has been deprecated and the XSS auditor it triggered has been removed from all major modern browsers (in favour of Content Security Policy) that implemented this header to begin with.</p>

<p><a href="https://github.com/rails/rails/pull/43673"><strong>Deprecate PerThreadRegistry</strong></a><br />
This module has been soft deprecated for a long time, but since it was used internally it wasn’t throwing deprecation warnings. Now it is. Apps should use <em>Module#thread_mattr_accessor</em> instead.</p>

<p><a href="https://contributors.rubyonrails.org/contributors/in-time-window/20211121-20211126">26 people</a> contributed to Rails since the last time. All the changes can be checked <a href="https://github.com/rails/rails/compare/@%7B2021-11-21%7D...main@%7B2021-11-26%7D">here</a>. Until next week!</p>


      </div>
    </div>
  </div>
</div>

<footer class="footer common-background--grey common-padding--bottom common-padding--top common-shape--top-white-up-left">
  <div class="footer__logo"><a href="/" aria-label="Ruby on Rails"></a></div>

  
</footer>

</body>
</html>
