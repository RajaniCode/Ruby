<!doctype html>
<html lang="en">








<head>
  <title>Ruby on Rails &mdash; 🚀 This Week in Rails: 2x String#blank? perf, assert_changes and more! 🚀</title>
  <meta charset="utf-8" />
  <meta content="ie=edge" http-equiv="x-ua-compatible" />
  <meta name="handheldfriendly" content="true" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Hello from Vipul.This was one busy week, with many changes landing on master. We had lots of performance improvements, bug fixes, new additions and enhancements.And here I thought everyone was just playing Pokemon Go now. " />

  <meta property="og:site_name" content="Ruby on Rails" />
  <meta property="og:title" content="🚀 This Week in Rails: 2x String#blank? perf, assert_changes and more! 🚀" />
  <meta property="og:description" content="Hello from Vipul.This was one busy week, with many changes landing on master. We had lots of performance improvements, bug fixes, new additions and enhancements.And here I thought everyone was just playing Pokemon Go now. " />
  <meta property="og:image" content="http://localhost:4000/assets/images/opengraph.png" />
  <meta property="og:url" content="http://localhost:4000/2016/7/24/this-week-in-rails-2x-string-blank-perf-assert_changes-and-more" />
  <meta property="og:type" content="article" />

  <meta name="twitter:title" content="🚀 This Week in Rails: 2x String#blank? perf, assert_changes and more! 🚀" />
  <meta name="twitter:description" content="Hello from Vipul.This was one busy week, with many changes landing on master. We had lots of performance improvements, bug fixes, new additions and enhancements.And here I thought everyone was just playing Pokemon Go now. " />
  <meta name="twitter:image" content="http://localhost:4000/assets/images/opengraph.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:creator" content="@rails" />
  <meta name="twitter:image:alt" content="Ruby on Rails" />

  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BlogPosting",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:4000/2016/7/24/this-week-in-rails-2x-string-blank-perf-assert_changes-and-more"
      },
      "name": "Ruby on Rails",
      "headline": "🚀 This Week in Rails: 2x String#blank? perf, assert_changes and more! 🚀",
      "description": "Hello from Vipul.This was one busy week, with many changes landing on master. We had lots of performance improvements, bug fixes, new additions and enhancements.And here I thought everyone was just playing Pokemon Go now. ",
      "url": "http://localhost:4000/2016/7/24/this-week-in-rails-2x-string-blank-perf-assert_changes-and-more",
      "image": "http://localhost:4000/assets/images/opengraph.png",
      "author": {
        "@type": "Person",
        "name": "vipulnsward"
      },
      "datePublished": "2016-07-24T00:00:00+05:30"
    }
  </script>
  <script defer data-domain="rubyonrails.org" src="https://plausible.io/js/script.js"></script>
  <link rel="icon" href="/assets/images/favicon.png" />
  <link rel="stylesheet" href="/assets/css/style.css" />
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="The official Ruby on Rails blog">
</head>


<body>


<nav class="nav">
  <a class="nav__logo" href="/" aria-label="Ruby on Rails"></a>

  <input class="nav__checkbox" id="nav__checkbox" type="checkbox" role="button" aria-label="menu" />

  <label class="nav__toggle" for="nav__checkbox">
    <span></span>
  </label>

  <div class="nav__options">
    <div>
      <ul>
        
          
            <li><a href="https://github.com/rails/rails"><span>Source</span></a></li>
          
        
          
            <li><a href="/docs"><span>Docs</span></a></li>
          
        
          
            <li><a href="/community"><span>Community</span></a></li>
          
        
          
            <li><a href="/blog"><span>News</span></a></li>
          
        
      </ul>

      <ul>
        
          
            <li><a href="/world"><span>Events</span></a></li>
          
        
          
            <li><a href="https://jobs.rubyonrails.org"><span>Jobs</span></a></li>
          
        
          
            <li><a href="https://merch.rubyonrails.org"><span>Merch</span></a></li>
          
        
          
            <li><a href="/foundation"><span>Foundation</span></a></li>
          
        
      </ul>
    </div>
  </div>
</nav>


<div class="layout">
  <div class="post common-padding--bottom common-padding--top-small">
    <div class="container">
      <div class="post__headline common-headline">
        <h5>Sunday, July 24, 2016</h5>
        <h2>🚀 This Week in Rails: 2x String#blank? perf, assert_changes and more! 🚀</h2>

        <h6>Posted by vipulnsward</h6>

      </div>
      <div class="post__content common-content common-content--post">
        <p>Hello from <a href="https://www.bigbinary.com/vipul">Vipul.</a></p>

<p>This was one busy week, with <a href="https://github.com/rails/rails/compare/master@%7B2016-07-16%7D...@%7B2016-07-22%7D">many changes</a> landing on master. <br />
We had lots of performance improvements, bug fixes, new additions and enhancements.</p>

<p>And here I thought everyone was just playing <a href="http://9gag.com/tv/p/abd8vL/pokemon-go-central-park-vaporeon">Pokemon Go</a> now. </p>

<h2 id="featured">Featured</h2>

<h3 id="kasper-joins-rails-core"><a href="https://rubyonrails.org/2016/7/19/Kasper-joins-Rails-core">Kasper joins Rails core!</a></h3>

<p>That’s right Kasper gets himself a cartoon face!</p>

<p>Kasper has helped make countless <a href="http://contributors.rubyonrails.org/contributors/kasper-timm-hansen/commits">changes</a> and helped <a href="https://github.com/rails/rails/issues?utf8=%E2%9C%93&amp;q=commenter%3Akaspth%20">others make them</a> as well.</p>

<p>He’s continued to making substantial, individual contributions, like the new partial collection <a href="https://github.com/rails/rails/pull/18948">caching</a> <a href="https://github.com/rails/rails/pull/23695">scheme</a>, <a href="https://github.com/rails/rails/pull/20904">wildcard template dependencies</a>, and <a href="https://github.com/rails/rails/pull/19571">big improvements to the test runner</a>.</p>

<h3 id="this-weeks-rails-contributors"><a href="http://contributors.rubyonrails.org/contributors/in-time-window/20160716-20160722">This Week’s Rails Contributors</a></h3>

<p>This week saw contributions from 30 fabulous people. 2 of those had a commit merged into Rails for the very first time.</p>

<p>A big thank you to you all! ❤️ If you fancy seeing yourself up there next week, why not take a peek at the list of <a href="https://goodbits.io/newsletters/19/emails/18495/**https://github.com/rails/rails/issues">current issues</a>? Improvements to the <a href="http://api.rubyonrails.org">documentation</a> can also be a great place to start!</p>

<h3 id="2x-performance-boost-for-stringblank-in-ruby-24"><a href="https://github.com/rails/rails/commit/929a6500806fe671d9ac0002da8537bf26b8f25d">2x performance boost for String#blank? in Ruby 2.4!</a></h3>

<p><em>String#blank?</em> now uses <em>Regex#match?</em> following the backwards compatible addition of <a href="https://github.com/rails/rails/commit/575dbeeefcaafeb566afc07cdd8b55603b698d9f"><em>Regex#match?</em></a> that was introduced.</p>

<p>This helps to get upto 2x the performance with new Regex improvements on Ruby 2.4!</p>

<h3 id="introduce-assert_changes-and-assert_no_changes"><a href="https://github.com/rails/rails/pull/25393">Introduce assert_changes and assert_no_changes</a></h3>

<p><em>ActiveSupport::TestCase</em> was augmented to complement <em>assert_difference</em> with a more more general usage.</p>

<p>With this handy comparison, we can now do something like-</p>

<p><em>user = User.start_registration<br />
assert_changes ‘user.token’, from: nil, to: /\w{​32}​/ do<br />
  user.finish_registration<br />
end</em>  <br />
to encapsulate the state changes, before and after an operation.</p>

<h2 id="new">New</h2>

<h3 id="bring-back-support-for-callable-cache-key-when-rendering-collection"><a href="https://github.com/rails/rails/pull/25616/files">Bring back support for callable cache key when rendering collection</a></h3>

<p>Support for custom callable cache key was added back to view caching. This allows us to do something like</p>

<p><em>&lt;%= render partial: ‘projects/project’, collection: @projects, cached: -&gt; project {​ [project, current_user] }​ %&gt;</em></p>

<p>and pass a key based on a callable block, which allows us to depend on cache’s and cache expiration based on result of the call. In the above case, the cache will be expired with changes to <em>project</em> and <em>current_user</em> objects.</p>

<h3 id="add-exists-and-update_all-to-collectionproxy-to-respect-an-association-scope"><a href="https://github.com/rails/rails/pull/25786/files">Add exists? and update_all to CollectionProxy to respect an association scope</a></h3>

<p>This change added <em>exists?</em> and <em>update_all</em> to <em>CollectionProxy</em> to respect an association scope.</p>

<p>This was causing issues in newest version of Rails whenever <em>update_all</em> or <em>exists?</em> were called on a collection object like <em>user.references.update_all(…)</em>.</p>

<h2 id="fixed">Fixed</h2>

<h3 id="fix-bug-in-activerecord-timezoneconverterset_time_zone_without_conversion"><a href="https://github.com/rails/rails/pull/25834">Fix bug in ActiveRecord TimeZoneConverter#set_time_zone_without_conversion</a></h3>

<p>Before this change, multi-parameter attributes conversion with invalid params caused issue, when AR’s <em>time_zone_aware_attributes</em> was enabled, since that caused an invalid conversion. </p>

<p>The new change, now tries conversion only when a valid value is available for safe-conversion.</p>

<h3 id="fix-calling-merge-method-as-the-first-occurrence-in-a-scope"><a href="https://github.com/rails/rails/pull/25849">Fix calling merge method as the first occurrence in a scope</a></h3>

<p>Previously calling merge as the first method to build up a scope used to lead to errors-</p>

<p><em>scope :unsafe_chaining, -&gt; {​ merge(Comment.newest) }​ #=&gt; NoMethodError:</em></p>

<p>This change now allows us to overcome this and build up scopes like-</p>

<p><em>scope :_chaining</em>, -&gt;{​merge(Comment.newest).joins(:comments) }​ # =&gt; OK_</p>

<h2 id="improved">Improved</h2>

<h3 id="allow-messageencryptor-to-take-advantage-of-authenticated-encryption-modes"><a href="https://github.com/rails/rails/commit/d4ea18a8cb84601509ee4c6dc691b212af8c2c36">Allow MessageEncryptor to take advantage of authenticated encryption modes</a></h3>

<p>This change allow MessageEncryptor to now support <a href="https://www.wikiwand.com/en/Authenticated_encryption">authenticated encryption modes</a>.</p>

<p>AEAD modes like <em>aes-256-gcm</em> provide both confidentiality and data authenticity, eliminating the need to use MessageVerifier to check if the encrypted data has been tampered with. This speeds up encryption/decryption and results in shorter cipher text.</p>

<h3 id="setup-default-session-store-internally-and-no-longer-through-an-initializer"><a href="https://github.com/rails/rails/pull/25438">Setup default session store internally, and no longer through an initializer</a></h3>

<p>This change removes creation of the <em>config/initializers/session_store.rb</em> to define session store via initializer and sets up default session store internally.</p>

<p>By default the session store will be set to cookie store with application name as session key.</p>

<h2 id="wrappin-up">Wrappin’ Up</h2>

<p>That’s it from This Week in Rails! There were many other great contributions, too numerous to list here, but feel free to <a href="https://github.com/rails/rails/compare/master@%7B2016-07-16%7D...@%7B2016-07-22%7D">check them out</a>!</p>

<p>Until next week!</p>


      </div>
    </div>
  </div>
</div>

<footer class="footer common-background--grey common-padding--bottom common-padding--top common-shape--top-white-up-left">
  <div class="footer__logo"><a href="/" aria-label="Ruby on Rails"></a></div>

  
</footer>

</body>
</html>
