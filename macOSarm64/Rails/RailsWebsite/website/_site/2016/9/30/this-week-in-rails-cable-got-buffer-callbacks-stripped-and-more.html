<!doctype html>
<html lang="en">








<head>
  <title>Ruby on Rails &mdash; This Week in Rails: cable got buffer, callbacks stripped, and more!</title>
  <meta charset="utf-8" />
  <meta content="ie=edge" http-equiv="x-ua-compatible" />
  <meta name="handheldfriendly" content="true" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Cadet, youâ€™re at the new frontier! Orbiting the red planet just yonder, you ponder and wonder:Do Martians drink their Martinis on the rocks?All this crew member knows is that he prefers his scoops on the Rails â€” good news, everyone: Weâ€™re setting course for such a delivery!" />

  <meta property="og:site_name" content="Ruby on Rails" />
  <meta property="og:title" content="This Week in Rails: cable got buffer, callbacks stripped, and more!" />
  <meta property="og:description" content="Cadet, youâ€™re at the new frontier! Orbiting the red planet just yonder, you ponder and wonder:Do Martians drink their Martinis on the rocks?All this crew member knows is that he prefers his scoops on the Rails â€” good news, everyone: Weâ€™re setting course for such a delivery!" />
  <meta property="og:image" content="http://localhost:4000/assets/images/opengraph.png" />
  <meta property="og:url" content="http://localhost:4000/2016/9/30/this-week-in-rails-cable-got-buffer-callbacks-stripped-and-more" />
  <meta property="og:type" content="article" />

  <meta name="twitter:title" content="This Week in Rails: cable got buffer, callbacks stripped, and more!" />
  <meta name="twitter:description" content="Cadet, youâ€™re at the new frontier! Orbiting the red planet just yonder, you ponder and wonder:Do Martians drink their Martinis on the rocks?All this crew member knows is that he prefers his scoops on the Rails â€” good news, everyone: Weâ€™re setting course for such a delivery!" />
  <meta name="twitter:image" content="http://localhost:4000/assets/images/opengraph.png" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:creator" content="@rails" />
  <meta name="twitter:image:alt" content="Ruby on Rails" />

  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BlogPosting",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:4000/2016/9/30/this-week-in-rails-cable-got-buffer-callbacks-stripped-and-more"
      },
      "name": "Ruby on Rails",
      "headline": "This Week in Rails: cable got buffer, callbacks stripped, and more!",
      "description": "Cadet, youâ€™re at the new frontier! Orbiting the red planet just yonder, you ponder and wonder:Do Martians drink their Martinis on the rocks?All this crew member knows is that he prefers his scoops on the Rails â€” good news, everyone: Weâ€™re setting course for such a delivery!",
      "url": "http://localhost:4000/2016/9/30/this-week-in-rails-cable-got-buffer-callbacks-stripped-and-more",
      "image": "http://localhost:4000/assets/images/opengraph.png",
      "author": {
        "@type": "Person",
        "name": "kaspth"
      },
      "datePublished": "2016-09-30T00:00:00+05:30"
    }
  </script>
  <script defer data-domain="rubyonrails.org" src="https://plausible.io/js/script.js"></script>
  <link rel="icon" href="/assets/images/favicon.png" />
  <link rel="stylesheet" href="/assets/css/style.css" />
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="The official Ruby on Rails blog">
</head>


<body>


<nav class="nav">
  <a class="nav__logo" href="/" aria-label="Ruby on Rails"></a>

  <input class="nav__checkbox" id="nav__checkbox" type="checkbox" role="button" aria-label="menu" />

  <label class="nav__toggle" for="nav__checkbox">
    <span></span>
  </label>

  <div class="nav__options">
    <div>
      <ul>
        
          
            <li><a href="https://github.com/rails/rails"><span>Source</span></a></li>
          
        
          
            <li><a href="/docs"><span>Docs</span></a></li>
          
        
          
            <li><a href="/community"><span>Community</span></a></li>
          
        
          
            <li><a href="/blog"><span>News</span></a></li>
          
        
      </ul>

      <ul>
        
          
            <li><a href="/world"><span>Events</span></a></li>
          
        
          
            <li><a href="https://jobs.rubyonrails.org"><span>Jobs</span></a></li>
          
        
          
            <li><a href="https://merch.rubyonrails.org"><span>Merch</span></a></li>
          
        
          
            <li><a href="/foundation"><span>Foundation</span></a></li>
          
        
      </ul>
    </div>
  </div>
</nav>


<div class="layout">
  <div class="post common-padding--bottom common-padding--top-small">
    <div class="container">
      <div class="post__headline common-headline">
        <h5>Friday, September 30, 2016</h5>
        <h2>This Week in Rails: cable got buffer, callbacks stripped, and more!</h2>

        <h6>Posted by kaspth</h6>

      </div>
      <div class="post__content common-content common-content--post">
        <p>Cadet, youâ€™re at the new frontier! Orbiting the red planet just yonder, you ponder and wonder:</p>

<p><em>Do Martians drink their Martinis on the rocks?</em></p>

<p>All <a href="https://twitter.com/kaspth">this crew member</a> knows is that he prefers his scoops on the Rails â€” good news, everyone: Weâ€™re setting course for such a delivery!</p>

<h2 id="featured">Featured</h2>

<h3 id="this-weeks-multiplanetary-contributors"><a href="http://contributors.rubyonrails.org/contributors/in-time-window/20160924-20160930">This Weekâ€™s Multiplanetary Contributors</a></h3>

<p>22 contribunauts came aboard the contributor list this week with their precious commits harvested for the good of all. Youâ€™ve earned this heart of gold: ðŸ’›</p>

<h3 id="action-cable-buffers-socket-writes"><a href="https://github.com/rails/rails/pull/26646">Action Cable buffers socket writes</a></h3>

<p>Quoting the description:</p>

<p><em>Sockets can sometimes block, leading to reduced system throughput as threads get tied up.</em></p>

<p>Switching to incremental writing allows Action Cable to spread out writes such that a blocked socket canâ€™t block writes to other sockets.</p>

<h3 id="callbacks-leaves-less-backtrace-lines"><a href="https://github.com/rails/rails/pull/26147">Callbacks leaves less backtrace lines</a></h3>

<p>Callbacks â€” <em>before_action</em> and friends â€” moved forward by going back this week: back to the backtrace and removing traces of itself. Try that, McFly!</p>

<p>Check the description for an example, itâ€™s quite easier to see in action.</p>

<h2 id="improved">Improved</h2>

<h3 id="rails-test-runner-supports-after_run-hooks"><a href="https://github.com/rails/rails/pull/26515">Railsâ€™ test runner supports <em>after_run</em> hooks</a></h3>

<p>The Rails test runner switched to using minitestâ€™s <em>autorun</em> across the board, as such it gained support for <em>Minitest.after_run</em> hooks.</p>

<p><em>autorun</em> also guards against running tests twice, which could happen in some cases. But thatâ€™s now fixed too.</p>

<h2 id="fixed">Fixed</h2>

<h3 id="dont-leak-activemodelerrors-default_proc"><a href="https://github.com/rails/rails/pull/26640">Donâ€™t leak <em>ActiveModel::Errors</em> <em>default_proc</em></a></h3>

<p>Previously when serializing <em>ActiveModel::Errors</em> via <em>to_hash</em> or <em>as_json</em> for instance, the <em>default_proc</em> would hide in the engine compartment and spring out when the crew was out of orbit.</p>

<p>No more of those alien capers on this ship!</p>

<h3 id="make-as-option-also-set-request-format"><a href="https://github.com/rails/rails/pull/26573">Make :as option also set request format</a></h3>

<p>In Rails 5 you can make an <em>as</em> of your test requests, <em>as: :json</em> that is.</p>

<p>After adding the option to <em>ActionController::TestCase</em> last week, weâ€™ve opened the pod bay doors once ensuring the <em>format</em> is just right_._</p>

<h2 id="wrapping-up">Wrapping up</h2>

<p>Thatâ€™s it for this week, as usual there were more changes than what we can fit, feel free to check them yourself <a href="https://github.com/rails/rails/compare/master@%7B2016-09-24%7D...@%7B2016-09-30%7D">here</a>!</p>

<p>Until next week!</p>


      </div>
    </div>
  </div>
</div>

<footer class="footer common-background--grey common-padding--bottom common-padding--top common-shape--top-white-up-left">
  <div class="footer__logo"><a href="/" aria-label="Ruby on Rails"></a></div>

  
</footer>

</body>
</html>
